---
title: "Homework 1"
author: "Kenneth Ruiter"
date: "October 8, 2018"
header-includes:
  \usepackage{enumerate}
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
\newpage

# For loops

## Exercise 2

\begin{enumerate}[(a)]
  \item
```{r Fibonnaci}
n <- 30
Fibonacci <- numeric(n)
Fibonacci[1] <- Fibonacci[2] <- 1
for (i in 3:n) {
  Fibonacci[i] <- Fibonacci[i-2] + Fibonacci[i-1]
}

convergingsequence <- Fibonacci[2:n]/Fibonacci[1:(n-1)]
```
The first 29 elements of the sequence of ratios of the form $f_n/f_{n-1}$ is given by: \\
\\
`r convergingsequence` \\
\\
Note that the sequence seems to be converging to about `r convergingsequence[29]`.
  
  \item
The golden ratio is $\frac{1+\sqrt{5}}{2} \approx$ `r (1+sqrt(5))/2`. This does seem to be the value that the sequence in part (a) is converging to. We will prove that this is the case. \\
\\
Let $n > 4$. Then 
$$\frac{f_n}{f_{n-1}} = \frac{f_{n-1}+f_{n-2}}{f_{n-1}} = 1 + \frac{f_{n-2}}{f_{n-2}+f_{n-3}} = 1+\frac{1}{\frac{f_{n-2}+f_{n-3}}{f_{n-2}}}.$$ 
Now note that we can rewrite the denominator of the final fraction, $\frac{f_{n-2}+f_{n-3}}{f_{n-2}}$, the same way as the second fraction, $\frac{f_{n-1}+f_{n-2}}{f_{n-1}}$, and as long as $n$ is big enough we can continue doing this. Thus if we are looking at the limit for $n$ to $\infty$, we can express the ratio as an "infinite fraction".
$$\frac{f_n}{f_{n-1}} = \frac{1}{1+\frac{1}{1+\frac{1}{\dots}}} $$
Now all that remains to be show is that this infinite fraction is equal to the golden ratio. To do this, let us first assign the value $x$ to it, such that $x = \frac{1}{1+\frac{1}{1+\frac{1}{\dots}}}$. However, then $1 + \frac{1}{x} = \frac{1}{1+\frac{1}{1+\frac{1}{1+\frac{1}{\dots}}}} = x$. Now we can simply compute $x$ from this quadratic equation.
$$1 + \frac{1}{x} = x \implies x^2 - x - 1=0 \implies x = \frac{1 \pm \sqrt{1-4*1*-1}}{2*1} = \frac{1\pm \sqrt{5}}{2}.$$
Noting that $x$ should be positive, finally proves that indeed $\frac{f_n}{f_{n-1}} \rightarrow \frac{1+ \sqrt{5}}{2}$, as $n \rightarrow \infty$.

\end{enumerate}

## Exercise 3

\begin{enumerate}[(a)]
  \item
We are taking $0$ and adding the numbers $1,2,3,4$ and $5$ to it to obtain $0+1+2+3+4+5=15$.
```{r}
answer <- 0
for (j in 1:5) {
  answer <- answer + j
}
```
Checking in R gives us that answer = `r answer`.

  \item
We begin with an empty set and then add the values $1$ to $5$ as elements to it, leaving us with the vector $(1,2,3,4,5)$.
```{r}
answer <- NULL
for(j in 1:5){
  answer <- c(answer,j)
}
```
Checking in R gives us that answer = (`r answer`).

  \item
Instead of beginning with an empty set, we now start with the value $0$. Adding the values $1$ to $5$ as elements results in the vector $(0,1,2,3,4,5)$.
```{r}
answer <- 0
for(j in 1:5){
  answer <- c(answer,j)
}
```
Checking in R gives us that answer = (`r answer`).

  \item
This time we are multiplying the answer by $1$ to $5$, so that the result is $1*1*2*3*4*5 = 120$.
```{r}
answer <- 1
for (j in 1:5) {
  answer <- answer * j
}
```
Checking in R gives us that answer = `r answer`.

  \item
Now we are creating a vector of $16$ elements, starting with $3$, where each next element is given by \linebreak $7*$(the last element) mod $31$. This gives the vector $(3,21,23,6,11,15,12,22,30,24,13,29,17,26,27,3)$.
```{r}
answer <- 3
for(j in 1:15){
  answer <- c(answer, (7*answer[j]) %% 31)
}
```
Checking in R gives us that answer = (`r answer`). Note here that the last element of the vector is the same as the first. By just inspecting the sequence of numbers, the pattern is not easy to see, however if we were to know (or guess) that the next element in the sequence is only dependent on the element preceding it, then we can predict that the successive element of the sequence is $21$, as this is also the value of the second element.

\end{enumerate}

\newpage
# If statements

## Exercise 4

```{r interest, echo=TRUE}
interest <- function(P, periods){
  if(periods <= 3){
    i <- 0.04 #Annual interest for a term 3 years or less
  } else {
    i <- 0.05 #Annual interest for a term more than 3 years
  }
  
  I <- P*((1+i)^periods - 1)
  return(I)
}
```

## Exercise 5

```{r mortgage payment, echo=TRUE}
mortgage <- function(n, P, open){
  if(open){
    i <- 0.005 #Interest rate when the morgage term is open
  } else {
    i <- 0.004 #Interest rate when the morgage term is closed
  }
  
  R <- P*i/(1-(1+i)^(-n))
  return(R)
}
```

\newpage
# While statements

## Exercise 2

```{r Fibonacci revised, echo=TRUE}
Fibonacci <- c(1,1)
while(Fibonacci[length(Fibonacci)] + Fibonacci[length(Fibonacci)-1] < 300){
  Fibonacci <- c(Fibonacci, Fibonacci[length(Fibonacci)] + Fibonacci[length(Fibonacci)-1])
}
```

## Exercise 4

```{r car dealer, echo=TRUE}
i <- 0.006
iOld <- -1
while(abs(i - iOld) > 0.000001){
  iOld <- i
  i <- (1-(1+i)^(-20))/19
}
```
Using a starting guess of $i=0.006$ results in an iteratively calculated value of $i=$ `r i`. The result will be about the same (with a maximal difference of $0.0000001$), for any starting value that is not close to $0$. This is the case as $0$ is also a fixed point, however it is unstable, unlike the value we find for $i$. Because of our initial choice of $iOld = -1$, a starting value close to $-1$ would also not give a desired result, however a negative guess for $i$ would not make sense for this example anyway.

## Exercise 5

```{r car dealer revised, echo=TRUE}
i <- 0.006
iOld <- -1
iterations <- 0
while(abs(i - iOld) > 0.000001){
  iterations <- iterations + 1
  iOld <- i
  i <- (1-(1+i)^(-20))/19
}
```
Again starting with $i=0.006$, we find our desired estimate of $i$ in `r iterations` iterations.

\newpage
# Break statements

## Exercise 2

\begin{enumerate}[(a)]
  \item
Done.

  \item
Let $p \geq \sqrt{n}$. Now consider any integer $q$, such that $p \leq q \leq n$. \\
If $q$ is prime, then it is still in $sieve$ as there cannot have been any number $\tilde{p}$ in $sieve$ smaller than $q$, such that $q = 0 \mod \tilde{p}$, by the definition of a prime number. \\
If $q$ is not prime, then there must exist integers $a,b \neq 1$ such that $q = a*b$. Now suppose $a,b > \sqrt{n}$. Then $q = a*b > \sqrt{n}*\sqrt{n} = n$, which contradicts our assumption, meaning that at least one of $a$ and $b$ must be smaller than or equal to $\sqrt{n}$. Without loss of generality, assume that $a \leq \sqrt{n}$. Now if $a$ is prime, then at some point we had that $p=a$, at which point then $q = 0 \mod p$, so $q$ can currently not be an element of $sieve$ anymore. If $a$ is not prime, then there must have been some point where $p = \tilde{a}$ where $a = 0 \mod p$. But then also $q = a*b = 0 \mod p$, meaning $q$ can currently still not be an element of $sieve$. Therefore all elements left in $sieve$ once $p \geq \sqrt{n}$ must be prime.

  \item
```{r Eratosthenes revised, echo=TRUE}
Erastosthenes <- function(n) {
  if(n >= 2) {
    sieve <- seq(2,n)
    primes <- c()
    repeat{
      p <- sieve[1]
      if(p >= sqrt(n)){
        primes <- c(primes, sieve)
        break
      }
      primes <- c(primes,p)
      sieve <- sieve[(sieve %% p) != 0]
    }
    return(primes)
  } else {
    stop("Input value of n should be at least 2.")
  }
}
```

\end{enumerate}
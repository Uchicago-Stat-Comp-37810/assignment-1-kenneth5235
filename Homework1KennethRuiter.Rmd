---
title: "Homework 1"
author: "Kenneth Ruiter"
date: "October 8, 2018"
header-includes:
  \usepackage{enumerate}
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
\newpage

# For loops

## Exercise 2

\begin{enumerate}[(a)]
  \item
```{r Fibonnaci}
n <- 30
Fibonacci <- numeric(n)
Fibonacci[1] <- Fibonacci[2] <- 1
for (i in 3:n) {
  Fibonacci[i] <- Fibonacci[i-2] + Fibonacci[i-1]
}

convergingsequence <- Fibonacci[2:n]/Fibonacci[1:(n-1)]
```
The first 29 elements of the sequence of ratios of the form $f_n/f_{n-1}$ is given by: \\
\\
`r convergingsequence` \\
\\
Note that the sequence seems to be converging to about `r convergingsequence[29]`.
  
  \item
The golden ratio is $\frac{1+\sqrt{5}}{2} \approx$ `r (1+sqrt(5))/2`. This does seem to be the value that the sequence in part (a) is converging to. We will prove that this is the case. \\
\\
Let $n > 4$. Then 
$$\frac{f_n}{f_{n-1}} = \frac{f_{n-1}+f_{n-2}}{f_{n-1}} = 1 + \frac{f_{n-2}}{f_{n-2}+f_{n-3}} = 1+\frac{1}{\frac{f_{n-2}+f_{n-3}}{f_{n-2}}}.$$ 
Now note that we can rewrite the denominator of the final fraction, $\frac{f_{n-2}+f_{n-3}}{f_{n-2}}$, the same way as the second fraction, $\frac{f_{n-1}+f_{n-2}}{f_{n-1}}$, and as long as $n$ is big enough we can continue doing this. Thus if we are looking at the limit for $n$ to $\infty$, we can express the ratio as an "infinite fraction".
$$\frac{f_n}{f_{n-1}} = \frac{1}{1+\frac{1}{1+\frac{1}{\dots}}} $$
Now all that remains to be show is that this infinite fraction is equal to the golden ratio. To do this, let us first assign the value $x$ to it, such that $x = \frac{1}{1+\frac{1}{1+\frac{1}{\dots}}}$. However, then $1 + \frac{1}{x} = \frac{1}{1+\frac{1}{1+\frac{1}{1+\frac{1}{\dots}}}} = x$. Now we can simply compute $x$ from this quadratic equation.
$$1 + \frac{1}{x} = x \implies x^2 - x - 1=0 \implies x = \frac{1 \pm \sqrt{1-4*1*-1}}{2*1} = \frac{1\pm \sqrt{5}}{2}.$$
Noting that $x$ should be positive, finally proves that indeed $\frac{f_n}{f_{n-1}} \rightarrow \frac{1+ \sqrt{5}}{2}$, as $n \rightarrow \infty$.

\end{enumerate}

## Exercise 3

\begin{enumerate}[(a)]
  \item
We are taking $0$ and adding the numbers $1,2,3,4$ and $5$ to it to obtain $0+1+2+3+4+5=15$.
```{r}
answer <- 0
for (j in 1:5) {
  answer <- answer + j
}
```
Checking in R gives us that answer = `r answer`.

  \item
We begin with an empty set and then add the values $1$ to $5$ as elements to it, leaving us with the vector $(1,2,3,4,5)$.
```{r}
answer <- NULL
for(j in 1:5){
  answer <- c(answer,j)
}
```
Checking in R gives us that answer = (`r answer`).

  \item
Instead of beginning with an empty set, we now start with the value $0$. Adding the values $1$ to $5$ as elements results in the vector $(0,1,2,3,4,5)$.
```{r}
answer <- 0
for(j in 1:5){
  answer <- c(answer,j)
}
```
Checking in R gives us that answer = (`r answer`).

  \item
This time we are multiplying the answer by $1$ to $5$, so that the result is $1*1*2*3*4*5 = 120$.
```{r}
answer <- 1
for (j in 1:5) {
  answer <- answer * j
}
```
Checking in R gives us that answer = `r answer`.

  \item
Now we are creating a vector of $16$ elements, starting with $3$, where each next element is given by \linebreak $7*$(the last element) mod $31$. This gives the vector $(3,21,23,6,11,15,12,22,30,24,13,29,17,26,27,3)$.
```{r}
answer <- 3
for(j in 1:15){
  answer <- c(answer, (7*answer[j]) %% 31)
}
```
Checking in R gives us that answer = (`r answer`). Note here that the last element of the vector is the same as the first. By just inspecting the sequence of numbers, the pattern is not easy to see, however if we were to know (or guess) that the next element in the sequence is only dependent on the element preceding it, then we can predict that the successive element of the sequence is $21$, as this is also the value of the second element.

\end{enumerate}

# If statements

## Exercise 4

```{r interest, echo=TRUE}
interest <- function(P, periods){
  if(periods <= 3){
    i <- 0.04 #Annual interest for a term 3 years or less
  } else {
    i <- 0.05 #Annual interest for a term more than 3 years
  }
  
  I <- P*((1+i)^periods - 1)
  return(I)
}
```

## Exercise 5

```{r mortgage payment, echo=TRUE}
mortgage <- function(n, P, open){
  if(open){
    i <- 0.005 #Interest rate when the morgage term is open
  } else {
    i <- 0.004 #Interest rate when the morgage term is closed
  }
  
  R <- P*i/(1-(1+i)^(-n))
  return(R)
}
```
